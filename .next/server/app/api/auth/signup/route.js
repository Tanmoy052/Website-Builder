"use strict";(()=>{var e={};e.id=654,e.ids=[654],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6005:e=>{e.exports=require("node:crypto")},1740:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>I,patchFetch:()=>T,requestAsyncStorage:()=>x,routeModule:()=>w,serverHooks:()=>P,staticGenerationAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{POST:()=>U});var i=r(9303),a=r(8716),n=r(670),o=r(7070),u=r(889),d=r(2023),p=r.n(d),c=r(6005),h=r.n(c);let l={randomUUID:h().randomUUID},f=new Uint8Array(256),m=f.length,g=[];for(let e=0;e<256;++e)g.push((e+256).toString(16).slice(1));let y=function(e,t,r){if(l.randomUUID&&!t&&!e)return l.randomUUID();let s=(e=e||{}).random||(e.rng||function(){return m>f.length-16&&(h().randomFillSync(f),m=0),f.slice(m,m+=16)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return function(e,t=0){return(g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]).toLowerCase()}(s)};async function U(e){try{let{email:t,password:r}=await e.json();if(await u.db.findUserByEmail(t))return o.NextResponse.json({error:"User already exists"},{status:400});let s=await p().hash(r,12),i={id:y(),email:t,passwordHash:s,isVerified:!1,createdAt:new Date};await u.db.createUser(i);let a=Math.floor(1e5+9e5*Math.random()).toString(),n=await p().hash(a,10);return await u.db.saveOTP({userId:i.id,otpHash:n,expiresAt:new Date(Date.now()+6e5),used:!1}),console.log(`OTP for ${t}: ${a}`),o.NextResponse.json({message:"User created. Please verify with OTP sent to your email.",userId:i.id})}catch(e){return o.NextResponse.json({error:"Internal Server Error"},{status:500})}}let w=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"C:\\Users\\tanmo\\Downloads\\website-builder\\app\\api\\auth\\signup\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:v,serverHooks:P}=w,I="/api/auth/signup/route";function T(){return(0,n.patchFetch)({serverHooks:P,staticGenerationAsyncStorage:v})}},889:(e,t,r)=>{r.d(t,{db:()=>i});class s{async findUserByEmail(e){return this.users.find(t=>t.email===e)}async createUser(e){return this.users.push(e),e}async updateUserVerification(e,t){let r=this.users.find(t=>t.email===e);r&&(r.isVerified=t)}async saveOTP(e){this.otps=this.otps.filter(t=>t.userId!==e.userId),this.otps.push(e)}async getOTP(e){return this.otps.find(t=>t.userId===e)}async markOTPUsed(e){let t=this.otps.find(t=>t.userId===e);t&&(t.used=!0)}async saveChat(e){return this.chats.push(e),e}async saveProject(e){return this.projects.push(e),e}async getUserHistory(e){return{chats:this.chats.filter(t=>t.userId===e).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()),projects:this.projects.filter(t=>t.userId===e).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()),files:this.files.filter(t=>t.userId===e).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}}constructor(){this.users=[],this.chats=[],this.projects=[],this.files=[],this.otps=[]}}let i=new s}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,972,23],()=>r(1740));module.exports=s})();